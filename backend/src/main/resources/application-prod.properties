# ==============================================================
# Production Profile - DigitalOcean Deployment with PostgreSQL
# ==============================================================
# All sensitive values come from environment variables
# ==============================================================

spring.application.name=ArtworkEcommerce

# ===== DATABASE (PostgreSQL) =====
# DATABASE_URL is parsed by DatabaseConfig.java
# DigitalOcean provides: postgresql://user:password@host:port/database?sslmode=require
# Local fallback (when DATABASE_URL is not set):
spring.datasource.url=jdbc:postgresql://localhost:5432/artwork
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate for PostgreSQL
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.open-in-view=false

# Connection pool
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.max-lifetime=1800000

# ===== FLYWAY (Disabled - using Hibernate auto-update) =====
# Flyway migrations are MySQL-specific, so we disable for PostgreSQL
spring.flyway.enabled=false

# ===== CACHING =====
# Set CACHE_TYPE=redis and REDIS_URL in environment to enable Redis caching
# REDIS_URL format: redis://user:password@host:port or rediss://user:password@host:port (for SSL)
spring.cache.type=${CACHE_TYPE:simple}
spring.data.redis.url=${REDIS_URL:}
spring.data.redis.timeout=5000ms
spring.data.redis.connect-timeout=5000ms
spring.data.redis.lettuce.pool.enabled=${REDIS_POOL_ENABLED:false}
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=4
spring.data.redis.lettuce.pool.min-idle=0

# ===== JWT =====
jwt.secret=${JWT_SECRET:CHANGE_ME_IN_PRODUCTION}
jwt.expiration=3600000
jwt.refresh.expiration=604800000

# ===== OAUTH2 =====
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID:}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET:}
spring.security.oauth2.client.registration.google.scope=openid,profile,email
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}

# ===== APPLICATION URLs =====
app.base-url=${BACKEND_URL:https://octopus-app-7g74s.ondigitalocean.app}
frontend.base-url=${FRONTEND_URL:https://makemycrafts.com}
app.oauth2.authorized-redirect-uri=${FRONTEND_URL:https://makemycrafts.com}/auth/oauth2/callback

# ===== CORS =====
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://makemycrafts.com,https://www.makemycrafts.com}

# ===== EMAIL (GoDaddy SMTP) =====
# Environment variables (Spring Boot auto-maps these):
#   - SPRING_MAIL_HOST: smtpout.secureserver.net (GoDaddy Workspace)
#                       or smtp.office365.com (Microsoft 365)
#   - SPRING_MAIL_PORT: 587 (TLS) or 465 (SSL)
#   - SPRING_MAIL_USERNAME: Your full email address
#   - SPRING_MAIL_PASSWORD: Your email password (REQUIRED!)
#
# These are default values - environment variables will override them
spring.mail.host=smtpout.secureserver.net
spring.mail.port=587
spring.mail.username=mail@makemycrafts.com
spring.mail.password=
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=*
spring.mail.properties.mail.smtp.ssl.protocols=TLSv1.2
spring.mail.properties.mail.smtp.connectiontimeout=15000
spring.mail.properties.mail.smtp.timeout=15000
spring.mail.properties.mail.smtp.writetimeout=15000
spring.mail.properties.mail.debug=${MAIL_DEBUG:false}
spring.mail.properties.from=mail@makemycrafts.com
mail.from=mail@makemycrafts.com
admin.email=${ADMIN_EMAIL:admin@makemycrafts.com}

# ===== CLOUDINARY =====
cloudinary.enabled=${CLOUDINARY_ENABLED:false}
cloudinary.cloud-name=${CLOUDINARY_CLOUD_NAME:}
cloudinary.api-key=${CLOUDINARY_API_KEY:}
cloudinary.api-secret=${CLOUDINARY_API_SECRET:}

# ===== RAZORPAY =====
razorpay.key.id=${RAZORPAY_KEY_ID:}
razorpay.key.secret=${RAZORPAY_KEY_SECRET:}
razorpay.webhook.secret=${RAZORPAY_WEBHOOK_SECRET:}

# Razorpay Route (Split Payments)
razorpay.route.enabled=${RAZORPAY_ROUTE_ENABLED:false}

# Razorpay X (Payouts)
razorpay.x.enabled=${RAZORPAY_X_ENABLED:false}
razorpay.x.account.number=${RAZORPAY_X_ACCOUNT_NUMBER:}

# ===== GEMINI AI =====
gemini.enabled=${GEMINI_ENABLED:true}
gemini.api.key=${GEMINI_API_KEY}
gemini.api.url=${GEMINI_API_URL:https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent}
gemini.model=${GEMINI_MODEL:gemini-2.0-flash-exp}
gemini.max-tokens=${GEMINI_MAX_TOKENS:8192}
gemini.temperature=${GEMINI_TEMPERATURE:0.7}

# ===== FILE UPLOAD =====
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=50MB
uploads.path=/app/uploads

# ===== LOGGING =====
logging.level.root=INFO
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN
logging.level.com.artwork=INFO
logging.level.org.hibernate.SQL=WARN

# ===== ACTUATOR (Health Checks) =====
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always
management.health.db.enabled=true
management.health.redis.enabled=${REDIS_HEALTH_ENABLED:false}

# ===== RATE LIMITER =====
resilience4j.ratelimiter.instances.authRateLimiter.limit-for-period=100
resilience4j.ratelimiter.instances.authRateLimiter.limit-refresh-period=1m
resilience4j.ratelimiter.instances.authRateLimiter.timeout-duration=0

resilience4j.ratelimiter.instances.artworkQueryRateLimiter.limit-for-period=500
resilience4j.ratelimiter.instances.artworkQueryRateLimiter.limit-refresh-period=1m
resilience4j.ratelimiter.instances.artworkQueryRateLimiter.timeout-duration=0

# ===== REVIEW SETTINGS =====
review.window.days=7
review.edit.window.days=3

# ===== SERVER =====
server.port=${PORT:8081}
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s
